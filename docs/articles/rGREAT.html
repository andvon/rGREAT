<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyze with GREAT • rGREAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyze with GREAT">
<meta property="og:description" content="rGREAT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rGREAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.19.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rGREAT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/rGREAT/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analyze with GREAT</h1>
                        <h4 class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de">z.gu@dkfz.de</a> )</h4>
            
            <h4 class="date">2020-04-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/rGREAT/blob/master/vignettes/rGREAT.Rmd"><code>vignettes/rGREAT.Rmd</code></a></small>
      <div class="hidden name"><code>rGREAT.Rmd</code></div>

    </div>

    
    
<p><strong>Note: <a href="http://great.stanford.edu/help/display/GREAT/Version+History">On Aug 19 2019 GREAT released version 4</a> where it supports <code>hg38</code> genome and removes some ontologies such pathways. <code><a href="../reference/submitGreatJob.html">submitGreatJob()</a></code> still takes <code>hg19</code> as default. <code>hg38</code> can be specified by the <code>species = "hg38"</code> argument. To use the older versions such as 3.0.0, specify as <code><a href="../reference/submitGreatJob.html">submitGreatJob(..., version = "3.0.0")</a></code>.</strong></p>
<p><strong>GREAT</strong> (<a href="http://great.stanford.edu">Genomic Regions Enrichment of Annotations Tool</a>) is a popular web-based tool to associate biological functions to genomic regions. The <strong>rGREAT</strong> package makes GREAT anlaysis automatic by first constructing a HTTP POST request according to user’s input and retrieving results from <strong>GREAT</strong> web server afterwards.</p>
<p>Load the package:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rGREAT</span>)</pre></body></html></div>
<p>The input data is either a <code>GRanges</code> object or a <em>BED</em>-format data frame, no matter it is sorted or not. In following example, we use a data frame which is randomly generated.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">bed</span> <span class="kw">=</span> <span class="kw pkg">circlize</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/generateRandomBed.html">generateRandomBed</a></span>(<span class="kw">nr</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">nc</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="no">bed</span>[<span class="fl">1</span>:<span class="fl">2</span>, ]</pre></body></html></div>
<pre><code>##    chr   start      end
## 1 chr1 7634457  9204434
## 2 chr1 9853594 10435028</code></pre>
<p>Submit genomic regions by <code><a href="../reference/submitGreatJob.html">submitGreatJob()</a></code>. Before submitting, genomic regions will be sorted and overlapping regions will be merged.</p>
<p>The returned variable <code>job</code> is a <code>GreatJob</code> class instance which can be used to retrieve results from <strong>GREAT</strong> server and stored results which are already downloaded.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>)</pre></body></html></div>
<p>You can get the summary of your job by directly calling <code>job</code> variable.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">job</span></pre></body></html></div>
<pre><code>## Submit time: 2020-04-20 13:57:30 
## Version: 4.0.4 
## Species: hg19 
## Inputs: 1005 regions
## Background: wholeGenome 
## Model: Basal plus extension 
##   Proximal: 5 kb upstream, 1 kb downstream,
##   plus Distal: up to 1000 kb
## Include curated regulatory domains
## 
## Enrichment tables for following ontologies have been downloaded:
##   None</code></pre>
<p>More parameters can be set for the job:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>, <span class="kw">species</span> <span class="kw">=</span> <span class="st">"mm9"</span>)
<span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>, <span class="no">bg</span>, <span class="kw">species</span> <span class="kw">=</span> <span class="st">"mm9"</span>)
<span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>, <span class="kw">adv_upstream</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">adv_downstream</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">adv_span</span> <span class="kw">=</span> <span class="fl">2000</span>)
<span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="st">"twoClosest"</span>, <span class="kw">adv_twoDistance</span> <span class="kw">=</span> <span class="fl">2000</span>)
<span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>, <span class="kw">rule</span> <span class="kw">=</span> <span class="st">"oneClosest"</span>, <span class="kw">adv_oneDistance</span> <span class="kw">=</span> <span class="fl">2000</span>)</pre></body></html></div>
<p>Also you can choose different versions of GREAT for the analysis.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>, <span class="kw">version</span> <span class="kw">=</span> <span class="st">"3.0"</span>)
<span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>, <span class="kw">version</span> <span class="kw">=</span> <span class="st">"2.0"</span>)</pre></body></html></div>
<p>Available parameters are (following content is copied from <strong>GREAT</strong> website):</p>
<ul>
<li>
<code>species</code>: “hg38”, “hg19”, “mm10”, “mm9” are supported in GREAT version 4.x.x, “hg19”, “mm10”, “mm9”, “danRer7” are supported in GREAT version 3.x.x and “hg19”, “hg18”, “mm9”, “danRer7” are supported in GREAT version 2.x.x.</li>
<li>
<code>bgChoise</code>: Background regions. <code>wholeGenome</code> and <code>data</code>. If this value is set to <code>data</code>, <code>bg</code> argument should be specified</li>
<li>
<code>includeCuratedRegDoms</code>: Whether to include curated regulatory domains.</li>
<li>
<code>rule</code>: How to associate genomic regions to genes.
<ul>
<li>
<code>basalPlusExt</code>: mode ‘Basal plus extension’. Gene regulatory domain definition: Each gene is assigned a basal regulatory domain of a minimum distance upstream and downstream of the TSS (regardless of other nearby genes). The gene regulatory domain is extended in both directions to the nearest gene’s basal domain but no more than the maximum extension in one direction.
<ul>
<li>
<code>adv_upstream</code>: proximal extension to upstream (unit: kb)</li>
<li>
<code>adv_downstream</code>: proximal extension to downstream (unit: kb)</li>
<li>
<code>adv_span</code>: maximum extension (unit: kb)</li>
</ul>
</li>
<li>
<code>twoClosest</code>: mode ‘Two nearest genes’. Gene regulatory domain definition: Each gene is assigned a regulatory domain that extends in both directions to the nearest gene’s TSS but no more than the maximum extension in one direction.
<ul>
<li>
<code>adv_twoDistance</code>: maximum extension (unit: kb)</li>
</ul>
</li>
<li>
<code>oneClosest</code>: mode ‘Single nearest gene’. Gene regulatory domain definition: Each gene is assigned a regulatory domain that extends in both directions to the midpoint between the gene’s TSS and the nearest gene’s TSS but no more than the maximum extension in one direction.
<ul>
<li>
<code>adv_oneDistance</code>: maximum extension (unit: kb)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>With <code>job</code>, we can now retrieve results from <strong>GREAT</strong>. The first and the primary results are the tables which contain enrichment statistics for the analysis. By default it will retrieve results from three GO Ontologies and all pathway ontologies. All tables contains statistics for all terms no matter they are significant or not. Users can then make filtering yb self-defined cutoff.</p>
<p>There is a column for adjusted p-values by “BH” method. Other p-value adjustment methods can be applied by <code><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust()</a></code>.</p>
<p>The returned value of <code><a href="../reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables()</a></code> is a list of data frames in which each one corresponds to tables for single ontology. The structure of data frames are same as the tables on <strong>GREAT</strong> website.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">tb</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables</a></span>(<span class="no">job</span>)</pre></body></html></div>
<pre><code>## The default enrichment tables contain no associated genes for the input regions. You can
## set `download_by = 'tsv'` to download the complete table, but note only the top 500
## regions can be retreived. See the following link:
## 
## https://great-help.atlassian.net/wiki/spaces/GREAT/pages/655401/Export#Export-GlobalExport</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">tb</span>)</pre></body></html></div>
<pre><code>## [1] "GO Molecular Function" "GO Biological Process" "GO Cellular Component"</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="no">tb</span><span class="kw">[[</span><span class="fl">1</span>]][<span class="fl">1</span>:<span class="fl">2</span>, ]</pre></body></html></div>
<pre><code>##           ID                                         name Binom_Genome_Fraction Binom_Expected
## 1 GO:0016798 hydrolase activity, acting on glycosyl bonds          0.0100418100     10.0920200
## 2 GO:0051787                    misfolded protein binding          0.0007646973      0.7685208
##   Binom_Observed_Region_Hits Binom_Fold_Enrichment Binom_Region_Set_Coverage Binom_Raw_PValue
## 1                         20              1.981763                 0.0199005      0.003633144
## 2                          4              5.204804                 0.0039801      0.007894598
##   Binom_Adjp_BH Hyper_Total_Genes Hyper_Expected Hyper_Observed_Gene_Hits Hyper_Fold_Enrichment
## 1             1               127      10.756210                       17              1.580482
## 2             1                12       1.016335                        4              3.935710
##   Hyper_Gene_Set_Coverage Hyper_Term_Gene_Coverage Hyper_Raw_PValue Hyper_Adjp_BH
## 1             0.010821130                0.1338583       0.03955741     1.0000000
## 2             0.002546149                0.3333333       0.01458949     0.6280924</code></pre>
<p>Information stored in <code>job</code> will be updated after retrieving enrichment tables.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">job</span></pre></body></html></div>
<pre><code>## Submit time: 2020-04-20 13:57:30 
## Version: 4.0.4 
## Species: hg19 
## Inputs: 1005 regions
## Background: wholeGenome 
## Model: Basal plus extension 
##   Proximal: 5 kb upstream, 1 kb downstream,
##   plus Distal: up to 1000 kb
## Include curated regulatory domains
## 
## Enrichment tables for following ontologies have been downloaded:
##   GO Biological Process
##   GO Cellular Component
##   GO Molecular Function</code></pre>
<p>You can get results by either specifying the ontologies or by the pre-defined categories (categories already contains pre-defined sets of ontologies):</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">tb</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables</a></span>(<span class="no">job</span>, <span class="kw">ontology</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GO Molecular Function"</span>, <span class="st">"BioCyc Pathway"</span>))
<span class="no">tb</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables</a></span>(<span class="no">job</span>, <span class="kw">category</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GO"</span>))</pre></body></html></div>
<p>As you have seen in the previous messages and results, The enrichment tables contain no associated genes. However, you can set <code>download_by = 'tsv'</code> in <code><a href="../reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables()</a></code> to download the complete tables, but due to <a href="https://great-help.atlassian.net/wiki/spaces/GREAT/pages/655401/Export#Export-GlobalExport">the restriction from GREAT web server</a>, only the top 500 regions can be retreived.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">tb2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables</a></span>(<span class="no">job</span>, <span class="kw">download_by</span> <span class="kw">=</span> <span class="st">"tsv"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">tb2</span><span class="kw">[[</span><span class="st">"GO Molecular Function"</span>]])</pre></body></html></div>
<pre><code>## [1] 500</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb2</span><span class="kw">[[</span><span class="st">"GO Molecular Function"</span>]])</pre></body></html></div>
<pre><code>##                Ontology         ID                                                 Desc BinomRank
## 1 GO Molecular Function GO:0016798         hydrolase activity, acting on glycosyl bonds         1
## 2 GO Molecular Function GO:0051787                            misfolded protein binding         2
## 3 GO Molecular Function GO:0016799 hydrolase activity, hydrolyzing N-glycosyl compounds         3
## 4 GO Molecular Function GO:0000900 translation repressor activity, nucleic acid binding         4
## 5 GO Molecular Function GO:0004844                    uracil DNA N-glycosylase activity         5
## 6 GO Molecular Function GO:0004553 hydrolase activity, hydrolyzing O-glycosyl compounds         6
##        BinomP BinomBonfP BinomFdrQ RegionFoldEnrich ExpRegions ObsRegions   GenomeFrac      SetCov
## 1 0.003633144          1         1         1.981763 10.0920200         20 0.0100418100 0.019900500
## 2 0.007894598          1         1         5.204804  0.7685208          4 0.0007646973 0.003980100
## 3 0.008692832          1         1         4.043178  1.2366510          5 0.0012304990 0.004975124
## 4 0.008774120          1         1         3.453267  1.7374850          6 0.0017288410 0.005970149
## 5 0.009371463          1         1        13.924090  0.1436360          2 0.0001429214 0.001990050
## 6 0.012096630          1         1         1.864224  9.1190760         17 0.0090737070 0.016915420
##   HyperRank       HyperP HyperBonfP  HyperFdrQ GeneFoldEnrich  ExpGenes ObsGenes TotalGenes
## 1       161 0.0395574100          1 1.00000000       1.580482 10.756210       17        127
## 2        98 0.0145894900          1 0.62809240       3.935710  1.016335        4         12
## 3       344 0.1102850000          1 1.00000000       2.146751  1.863281        4         22
## 4        26 0.0003721502          1 0.06038853       5.449444  1.101030        6         13
## 5       198 0.0603123900          1 1.00000000       4.722852  0.423473        2          5
## 6       180 0.0485899900          1 1.00000000       1.620586  8.638848       14        102
##    GeneSetCov   TermCov
## 1 0.010821130 0.1338583
## 2 0.002546149 0.3333333
## 3 0.002546149 0.1818182
## 4 0.003819223 0.4615385
## 5 0.001273074 0.4000000
## 6 0.008911521 0.1372549
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Regions
## 1 chr10:28982747-29009664,chr10:73401324-73765625,chr11:76186434-77258959,chr12:53623282-55658052,chr12:78776693-82267513,chr13:31546338-35719523,chr14:88100082-88802558,chr15:66717196-67068786,chr1:103764557-105740881,chr3:5263280-5764512,chr3:80776737-81360027,chr3:81815619-81922882,chr4:177298284-178454455,chr5:108206447-109354245,chr5:109583981-109647304,chr5:54399178-54715484,chr6:119435242-119806141,chr6:95026573-95490377,chr6:96124590-96566913,chr7:141672214-142165254
## 2                                                                                                                                                                                                                                                                                                                                                                                                chr22:21607529-22377646,chr2:182956275-184302935,chr3:5263280-5764512,chr5:174911166-178784645
## 3                                                                                                                                                                                                                                                                                                                                                                     chr12:53623282-55658052,chr4:177298284-178454455,chr5:108206447-109354245,chr5:109583981-109647304,chr5:54399178-54715484
## 4                                                                                                                                                                                                                                                                                                                                                chr10:93760800-93794630,chr17:38360990-38658964,chr18:34406674-37112725,chr4:14211768-14961015,chr5:172455557-174030576,chr5:79990154-80307883
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                chr12:53623282-55658052,chr5:54399178-54715484
## 6                                                                         chr10:28982747-29009664,chr10:73401324-73765625,chr11:76186434-77258959,chr12:78776693-82267513,chr13:31546338-35719523,chr14:88100082-88802558,chr15:66717196-67068786,chr1:103764557-105740881,chr3:5263280-5764512,chr3:80776737-81360027,chr3:81815619-81922882,chr5:108206447-109354245,chr5:109583981-109647304,chr6:119435242-119806141,chr6:95026573-95490377,chr6:96124590-96566913,chr7:141672214-142165254
##                                                                                                       Genes
## 1 ACER3,AMY1C,CCNO,EDEM1,ENSG00000257743,GALC,GBE1,KL,LCTL,LYZL1,MAN1A1,MAN2A1,MANEA,NEIL3,OTOGL,PSAP,SMUG1
## 2                                                                                  DNAJC10,EDEM1,F12,SDF2L1
## 3                                                                                   CCNO,MAN2A1,NEIL3,SMUG1
## 4                                                                         CELF4,CPEB2,CPEB3,CPEB4,DHFR,RARA
## 5                                                                                                CCNO,SMUG1
## 6                  ACER3,AMY1C,EDEM1,ENSG00000257743,GALC,GBE1,KL,LCTL,LYZL1,MAN1A1,MAN2A1,MANEA,OTOGL,PSAP</code></pre>
<p>All available ontology names for given species can be get by <code><a href="../reference/availableOntologies-GreatJob-method.html">availableOntologies()</a></code> and all available ontology categories can be get by <code><a href="../reference/availableCategories-GreatJob-method.html">availableCategories()</a></code>. Here you do not need to provide species information because <code>job</code> already contains it.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="../reference/availableOntologies-GreatJob-method.html">availableOntologies</a></span>(<span class="no">job</span>)</pre></body></html></div>
<pre><code>## [1] "GO Molecular Function"     "GO Biological Process"     "GO Cellular Component"    
## [4] "Mouse Phenotype"           "Mouse Phenotype Single KO" "Human Phenotype"          
## [7] "Ensembl Genes"</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="../reference/availableCategories-GreatJob-method.html">availableCategories</a></span>(<span class="no">job</span>)</pre></body></html></div>
<pre><code>## [1] "GO"        "Phenotype" "Genes"</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="../reference/availableOntologies-GreatJob-method.html">availableOntologies</a></span>(<span class="no">job</span>, <span class="kw">category</span> <span class="kw">=</span> <span class="st">"GO"</span>)</pre></body></html></div>
<pre><code>## [1] "GO Molecular Function" "GO Biological Process" "GO Cellular Component"</code></pre>
<p>Association between genomic regions and genes can be get by <code><a href="../reference/plotRegionGeneAssociationGraphs-GreatJob-method.html">plotRegionGeneAssociationGraphs()</a></code>. The function will make the three plots which are same as on <strong>GREAT</strong> website and returns a <code>GRanges</code> object which contains the gene-region associations.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">res</span> <span class="kw">=</span> <span class="fu"><a href="../reference/plotRegionGeneAssociationGraphs-GreatJob-method.html">plotRegionGeneAssociationGraphs</a></span>(<span class="no">job</span>)</pre></body></html></div>
<p><img src="rGREAT_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">res</span>[<span class="fl">1</span>:<span class="fl">2</span>, ]</pre></body></html></div>
<pre><code>## GRanges object with 2 ranges and 2 metadata columns:
##       seqnames          ranges strand |        gene   distTSS
##          &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;numeric&gt;
##   [1]     chr1 7634457-9204434      * |     SLC45A1     41560
##   [2]     chr1 7634457-9204434      * |        RERE    458078
##   -------
##   seqinfo: 24 sequences from an unspecified genome; no seqlengths</code></pre>
<p>For those regions that are not associated with any genes under current settings, the corresponding <code>gene</code> and <code>distTSS</code> columns will be <code>NA</code>.</p>
<p>You can also choose only plotting one of the three figures.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="../reference/plotRegionGeneAssociationGraphs-GreatJob-method.html">plotRegionGeneAssociationGraphs</a></span>(<span class="no">job</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p>By specifying ontology and term ID, you can get the association in a certain term. Here the term ID is from the first column of the data frame which is returned by <code><a href="../reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables()</a></code>.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">res</span> <span class="kw">=</span> <span class="fu"><a href="../reference/plotRegionGeneAssociationGraphs-GreatJob-method.html">plotRegionGeneAssociationGraphs</a></span>(<span class="no">job</span>, <span class="kw">ontology</span> <span class="kw">=</span> <span class="st">"GO Molecular Function"</span>,
    <span class="kw">termID</span> <span class="kw">=</span> <span class="st">"GO:0004984"</span>)</pre></body></html></div>
<pre><code>## The webpage for 'GOMolecularFunction:GO:0004984' is available at:
##   http://great.stanford.edu/public-4.0.4/cgi-bin/showTermDetails.php?termId=GO:0004984&amp;ontoName=GOMolecularFunction&amp;ontoUiName=GO Molecular Function&amp;sessionName=20200420-public-4.0.4-yTdQwC&amp;species=hg19&amp;foreName=file45c31348ef92.gz&amp;backName=&amp;table=region</code></pre>
<p><img src="rGREAT_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">res</span>[<span class="fl">1</span>:<span class="fl">2</span>, ]</pre></body></html></div>
<pre><code>## GRanges object with 2 ranges and 2 metadata columns:
##       seqnames              ranges strand |        gene   distTSS
##          &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;numeric&gt;
##   [1]     chr1 247871555-248931674      * |       OR2M4      -616
##   [2]     chr3   96368632-99050767      * |      OR5AC2    -96317
##   -------
##   seqinfo: 7 sequences from an unspecified genome; no seqlengths</code></pre>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</pre></body></html></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.2
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] rGREAT_1.19.2        GenomicRanges_1.36.1 GenomeInfoDb_1.20.0  IRanges_2.18.3      
## [5] S4Vectors_0.22.1     BiocGenerics_0.30.0  knitr_1.28          
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.4.6           compiler_3.6.2         XVector_0.24.0         bitops_1.0-6          
##  [5] tools_3.6.2            zlibbioc_1.30.0        digest_0.6.25          evaluate_0.14         
##  [9] memoise_1.1.0          rlang_0.4.5            yaml_2.2.1             pkgdown_1.5.1         
## [13] xfun_0.13              GenomeInfoDbData_1.2.1 stringr_1.4.0          desc_1.2.0            
## [17] fs_1.4.1               GlobalOptions_0.1.2    rprojroot_1.3-2        grid_3.6.2            
## [21] R6_2.4.1               GetoptLong_0.1.8       rmarkdown_2.1          magrittr_1.5          
## [25] backports_1.1.6        htmltools_0.4.0        MASS_7.3-51.5          assertthat_0.2.1      
## [29] shape_1.4.4            circlize_0.4.9         colorspace_1.4-1       stringi_1.4.6         
## [33] RCurl_1.98-1.1         crayon_1.3.4           rjson_0.2.20</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
