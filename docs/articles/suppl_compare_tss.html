<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suppl 4. Compare different TSS sources • rGREAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Suppl 4. Compare different TSS sources">
<meta property="og:description" content="rGREAT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rGREAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Online GREAT</li>
    <li>
      <a href="../articles/online-GREAT.html">Analyze with online GREAT</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Local GREAT</li>
    <li>
      <a href="../articles/local-GREAT.html">Analyze with local GREAT</a>
    </li>
    <li>
      <a href="../articles/other-geneset-databases.html">Work with other geneset databases</a>
    </li>
    <li>
      <a href="../articles/other-organisms.html">Work with other organisms</a>
    </li>
    <li>
      <a href="../articles/group_associations.html">Get gene-region associations for a group of GO terms</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Supplementaries in the rGREAT paper</li>
    <li>
      <a href="../articles/suppl_use_background.html">Suppl 1. Use background regions</a>
    </li>
    <li>
      <a href="../articles/suppl_compare_GO.html">Suppl 2. Compare GO annotations from online and local GREAT</a>
    </li>
    <li>
      <a href="../articles/suppl_compare_online_and_local.html">Suppl 3. Compare online and local GREAT</a>
    </li>
    <li>
      <a href="../articles/suppl_compare_tss.html">Suppl 4. Compare different TSS sources</a>
    </li>
    <li>
      <a href="../articles/suppl_compare_genome_version.html">Suppl 5. Compare different genome versions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/rGREAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Suppl 4. Compare different TSS sources</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 data-toc-skip class="date">2024-02-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/rGREAT/blob/HEAD/vignettes/suppl_compare_tss.Rmd" class="external-link"><code>vignettes/suppl_compare_tss.Rmd</code></a></small>
      <div class="hidden name"><code>suppl_compare_tss.Rmd</code></div>

    </div>

    
    
<p><code><a href="../reference/great.html">great()</a></code> supports various sources to obtain gene TSS. The sources can be one of:</p>
<ul>
<li>a <code>TxDb.*</code> package such as <strong>TxDb.Hsapiens.UCSC.hg38.knownGene</strong>,</li>
<li>RefSeq database (mainly the “RefSeq Select” subset (see <a href="https://genome.ucsc.edu/cgi-bin/hgTrackUi?db=hg38&amp;g=refSeqComposite" class="external-link uri">https://genome.ucsc.edu/cgi-bin/hgTrackUi?db=hg38&amp;g=refSeqComposite</a> for different subsets of RefSeq),</li>
<li>Gencode annotation,</li>
<li>TSS provided by GREAT itself.</li>
</ul>
<p>In this document, we will compare different TSS sources and their influence on GREAT enrichment analysis.</p>
<p>We use human genome hg38 here because there will be gene ID conversions (e.g. from Ensembl ID to Entrez ID for Gencode annotation), using the newest genome annotation version will reduce the inconsistency between different sources.</p>
<p>The helper function <code><a href="../reference/getTSS.html">getTSS()</a></code> extracts TSS from a specific source. Note genes in the four sources are protein-coding genes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/rGREAT" class="external-link">rGREAT</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'S4Vectors' was built under R version 4.3.2</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_txdb</span> <span class="op">=</span> <span class="fu"><a href="../reference/getTSS.html">getTSS</a></span><span class="op">(</span><span class="st">"TxDb.Hsapiens.UCSC.hg38.knownGene"</span><span class="op">)</span></span>
<span><span class="va">tss_gencode</span> <span class="op">=</span> <span class="fu"><a href="../reference/getTSS.html">getTSS</a></span><span class="op">(</span><span class="st">"gencode_v40"</span><span class="op">)</span></span>
<span><span class="va">tss_refseq</span> <span class="op">=</span> <span class="fu"><a href="../reference/getTSS.html">getTSS</a></span><span class="op">(</span><span class="st">"refseq:hg38"</span><span class="op">)</span></span>
<span><span class="va">tss_great</span> <span class="op">=</span> <span class="fu"><a href="../reference/getTSS.html">getTSS</a></span><span class="op">(</span><span class="st">"great:hg38"</span><span class="op">)</span></span></code></pre></div>
<p>Gene IDs in <code>tss_gencode</code> are Ensembl gene IDs, and gene IDs in <code>tss_great</code> are gene symbols. We convert them to Entrez gene IDs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">org.Hs.egENSEMBL2EG</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new_gene_id</span> <span class="op">=</span> <span class="va">map</span><span class="op">[</span><span class="va">tss_gencode</span><span class="op">$</span><span class="va">gene_id</span><span class="op">]</span></span>
<span><span class="va">tss_gencode</span><span class="op">$</span><span class="va">gene_id</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">new_gene_id</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="va">new_gene_id</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">new_gene_id</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">org.Hs.egSYMBOL2EG</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">new_gene_id</span> <span class="op">=</span> <span class="va">map</span><span class="op">[</span><span class="va">tss_great</span><span class="op">$</span><span class="va">gene_id</span><span class="op">]</span></span>
<span><span class="va">tss_great</span><span class="op">$</span><span class="va">gene_id</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">new_gene_id</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="va">new_gene_id</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">new_gene_id</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>We put all TSS objects into a single list:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_lt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    txdb_known_gene <span class="op">=</span> <span class="va">tss_txdb</span>,</span>
<span>    gencode <span class="op">=</span> <span class="va">tss_gencode</span>,</span>
<span>    refseq <span class="op">=</span> <span class="va">tss_refseq</span>,</span>
<span>    great <span class="op">=</span> <span class="va">tss_great</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tss_lt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tss_lt</span>, <span class="va">sort</span><span class="op">)</span></span></code></pre></div>
<p>We first look at the overlap of genes. It basically shows all five sources almost contain the same set of genes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tss_lt</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/make_comb_mat.html" class="external-link">make_comb_mat</a></span><span class="op">(</span><span class="va">lt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/UpSet.html" class="external-link">UpSet</a></span><span class="op">(</span><span class="va">cm</span>, column_title <span class="op">=</span> <span class="st">"Number of genes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="suppl_compare_tss_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Next we look at the overlap of TSS with their exact positions. There are quite a large disagreement between different TSS sources.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tss_lt</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/strand.html" class="external-link">strand</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">":"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/make_comb_mat.html" class="external-link">make_comb_mat</a></span><span class="op">(</span><span class="va">lt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/UpSet.html" class="external-link">UpSet</a></span><span class="op">(</span><span class="va">cm</span>, column_title <span class="op">=</span> <span class="st">"Number of TSS (with their exact positions)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="suppl_compare_tss_files/figure-html/unnamed-chunk-6-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Next we compare difference of TSS locations in different sources. We first take the common genes in all four sources.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_lt2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tss_lt</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span></span>
<span>    <span class="va">dp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tb</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">gene_id</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">dp</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">gene_id</span></span>
<span>    <span class="va">x</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">cn</span> <span class="op">=</span> <span class="va">tss_lt2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">gene_id</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tss_lt2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">cn</span>, <span class="va">tss_lt2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 17069</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_lt2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tss_lt2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">cn</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Next we perform pairwise comparisons for every pair of TSS sources.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/GetoptLong" class="external-link">GetoptLong</a></span><span class="op">)</span></span>
<span><span class="va">compare_tss_pos</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">tss1</span>, <span class="va">tss2</span>, <span class="va">name1</span>, <span class="va">name2</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">d1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">tss1</span><span class="op">)</span></span>
<span>    <span class="va">d2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">tss2</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">d1</span> <span class="op">-</span> <span class="va">d2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="st">"0"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="st">"1-5"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">diff</span> <span class="op">&lt;=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="st">"6-10"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&gt;=</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">diff</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="st">"11-50"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&gt;=</span> <span class="fl">11</span> <span class="op">&amp;</span> <span class="va">diff</span> <span class="op">&lt;=</span> <span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="st">"51-500"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&gt;=</span> <span class="fl">51</span> <span class="op">&amp;</span> <span class="va">diff</span> <span class="op">&lt;=</span> <span class="fl">500</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="st">"501-5kb"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&gt;=</span> <span class="fl">501</span> <span class="op">&amp;</span> <span class="va">diff</span> <span class="op">&lt;=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="st">"5kb-50kb"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&gt;=</span> <span class="fl">5001</span> <span class="op">&amp;</span> <span class="va">diff</span> <span class="op">&lt;=</span> <span class="fl">50000</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="st">"&gt;50kb"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&gt;=</span> <span class="fl">50001</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">v</span>, ylab <span class="op">=</span> <span class="st">"Number of TSS"</span>, </span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GetoptLong/man/qq.html" class="external-link">qq</a></span><span class="op">(</span><span class="st">"TSS dist_diff, @{name1} and @{name2}\nmean (trim 0.05) = @{round(mean(diff, trim = 0.05))}bp, median = @{median(diff)}bp"</span><span class="op">)</span>, </span>
<span>        las <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, ann <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tss_lt2</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="fu">compare_tss_pos</span><span class="op">(</span><span class="va">tss_lt2</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>, <span class="va">tss_lt2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tss_lt2</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tss_lt2</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16000</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="suppl_compare_tss_files/figure-html/unnamed-chunk-8-1.png" width="1152" style="display: block; margin: auto;"></p>
<p>Top 10 TSS which the highest variability of their positions:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/matrixStats" class="external-link">matrixStats</a></span><span class="op">)</span></span>
<span><span class="va">pos_mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tss_lt2</span>, <span class="va">start</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/matrixStats/man/rowSds.html" class="external-link">rowSds</a></span><span class="op">(</span><span class="va">pos_mat</span><span class="op">)</span></span>
<span><span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">v</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="va">pos_mat2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"chr"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqnames</a></span><span class="op">(</span><span class="va">tss_lt2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="va">pos_mat</span>, Entrez_ID <span class="op">=</span> <span class="va">tss_lt2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span></span>
<span><span class="va">pos_mat2</span> <span class="op">=</span> <span class="va">pos_mat2</span><span class="op">[</span><span class="va">ind</span>, <span class="op">]</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">org.Hs.egSYMBOL</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pos_mat2</span><span class="op">$</span><span class="va">Entrez_ID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GetoptLong/man/qq.html" class="external-link">qq</a></span><span class="op">(</span><span class="st">"[@{pos_mat2$Entrez_ID}](https://www.genecards.org/cgi-bin/carddisp.pl?gene=@{map[pos_mat2$Entrez_ID]}#genomic_location)"</span>, collapse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">pos_mat2</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">chr</th>
<th align="right">txdb_known_gene</th>
<th align="right">gencode</th>
<th align="right">refseq</th>
<th align="right">great</th>
<th align="left">Entrez_ID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">chr1</td>
<td align="right">58546734</td>
<td align="right">58546734</td>
<td align="right">57424060</td>
<td align="right">57424058</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=DAB1#genomic_location" class="external-link">1600</a></td>
</tr>
<tr class="even">
<td align="left">chrX</td>
<td align="right">37349330</td>
<td align="right">38561542</td>
<td align="right">38561542</td>
<td align="right">38561370</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=TSPAN7#genomic_location" class="external-link">7102</a></td>
</tr>
<tr class="odd">
<td align="left">chr11</td>
<td align="right">41459773</td>
<td align="right">41459773</td>
<td align="right">41459652</td>
<td align="right">40294115</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=LRRC4C#genomic_location" class="external-link">57689</a></td>
</tr>
<tr class="even">
<td align="left">chr3</td>
<td align="right">75906695</td>
<td align="right">75906695</td>
<td align="right">77040099</td>
<td align="right">75906695</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=ROBO2#genomic_location" class="external-link">6092</a></td>
</tr>
<tr class="odd">
<td align="left">chr8</td>
<td align="right">31639222</td>
<td align="right">31639222</td>
<td align="right">32548311</td>
<td align="right">32548635</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=NRG1#genomic_location" class="external-link">3084</a></td>
</tr>
<tr class="even">
<td align="left">chr17</td>
<td align="right">34157294</td>
<td align="right">34174964</td>
<td align="right">33293295</td>
<td align="right">33292989</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=ASIC2#genomic_location" class="external-link">40</a></td>
</tr>
<tr class="odd">
<td align="left">chr10</td>
<td align="right">55627942</td>
<td align="right">55627942</td>
<td align="right">54801231</td>
<td align="right">54801292</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=PCDH15#genomic_location" class="external-link">65217</a></td>
</tr>
<tr class="even">
<td align="left">chr16</td>
<td align="right">73891871</td>
<td align="right">73891871</td>
<td align="right">73048128</td>
<td align="right">73131095</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=ZFHX3#genomic_location" class="external-link">463</a></td>
</tr>
<tr class="odd">
<td align="left">chr16</td>
<td align="right">5239802</td>
<td align="right">5239802</td>
<td align="right">6019024</td>
<td align="right">6019703</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=RBFOX1#genomic_location" class="external-link">54715</a></td>
</tr>
<tr class="even">
<td align="left">chr3</td>
<td align="right">24687887</td>
<td align="right">24687887</td>
<td align="right">25428263</td>
<td align="right">25428311</td>
<td align="left"><a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene=RARB#genomic_location" class="external-link">5915</a></td>
</tr>
</tbody>
</table>
<div class="section level2">
<h2 id="influence-on-great-enrichment">Influence on GREAT enrichment<a class="anchor" aria-label="anchor" href="#influence-on-great-enrichment"></a>
</h2>
<p>Although TSSs have different positions in different sources, they are located quite closely. We next check whether the inconsistency of TSS positions affects the GREAT enrichment analysis.</p>
<p>In the next example, we use a dataset from <a href="https://genome.ucsc.edu/cgi-bin/hgTables" class="external-link">UCSC table browser</a>. The parameters are as follows:</p>
<pre><code>clade = Mammal
genome = Human
assembly = GRCh38/hg38
group = Regulation
track = TF ChIP
table = A549 MYC (encTfChipPkENCFF542GMN)</code></pre>
<p>Similarly, we perform local GREAT with four different TSS sources.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"data/A549_MYC_encTfChipPkENCFF542GMN_hg38.bed"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span>, <span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span>seqnames <span class="op">=</span> <span class="va">df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span>, <span class="va">df</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_txdb</span> <span class="op">=</span> <span class="fu"><a href="../reference/great.html">great</a></span><span class="op">(</span><span class="va">gr</span>, <span class="st">"GO:BP"</span>, <span class="st">"TxDb.Hsapiens.UCSC.hg38.knownGene"</span>, min_gene_set_size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">res_gencode</span> <span class="op">=</span> <span class="fu"><a href="../reference/great.html">great</a></span><span class="op">(</span><span class="va">gr</span>, <span class="st">"GO:BP"</span>, <span class="st">"gencode_v40"</span>, min_gene_set_size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">res_refseq</span> <span class="op">=</span> <span class="fu"><a href="../reference/great.html">great</a></span><span class="op">(</span><span class="va">gr</span>, <span class="st">"GO:BP"</span>, <span class="st">"refseq:hg38"</span>, min_gene_set_size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">res_great</span> <span class="op">=</span> <span class="fu"><a href="../reference/great.html">great</a></span><span class="op">(</span><span class="va">gr</span>, <span class="st">"GO:BP"</span>, <span class="st">"great:hg38"</span>, min_gene_set_size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    txdb_known_gene <span class="op">=</span> <span class="va">res_txdb</span>,</span>
<span>    gencode <span class="op">=</span> <span class="va">res_gencode</span>,</span>
<span>    refseq <span class="op">=</span> <span class="va">res_refseq</span>,</span>
<span>    great <span class="op">=</span> <span class="va">res_great</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We check the overlap of significant GO terms:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/getEnrichmentTable-dispatch.html">getEnrichmentTable</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tb_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">p_adjust</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/make_comb_mat.html" class="external-link">make_comb_mat</a></span><span class="op">(</span><span class="va">lt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/UpSet.html" class="external-link">UpSet</a></span><span class="op">(</span><span class="va">cm</span>, column_title <span class="op">=</span> <span class="st">"Number of significant GO terms (FDR &lt; 0.01)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="suppl_compare_tss_files/figure-html/unnamed-chunk-11-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/getEnrichmentTable-dispatch.html">getEnrichmentTable</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">tb_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">id</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">tb_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">id</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">tb_list</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">id</span>, <span class="va">tb_list</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tb_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">id</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">cn</span>, <span class="st">"fold_enrichment"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, ann <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vl</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vl</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>, <span class="va">vl</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vl</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vl</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, </span>
<span>                col <span class="op">=</span> <span class="st">"#00000020"</span>, main <span class="op">=</span> <span class="st">"log2(Fold enrichment)"</span>,</span>
<span>                xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="suppl_compare_tss_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The results shows the enrichments are very consistent for the four different TSS sources.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Ventura 13.2.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Berlin</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] grid      stats4    stats     graphics  grDevices utils     datasets </span></span>
<span><span class="co">## [8] methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] matrixStats_1.2.0     GetoptLong_1.0.5      ComplexHeatmap_2.18.0</span></span>
<span><span class="co">##  [4] org.Hs.eg.db_3.17.0   AnnotationDbi_1.62.2  Biobase_2.60.0       </span></span>
<span><span class="co">##  [7] rGREAT_2.5.4          GenomicRanges_1.52.1  GenomeInfoDb_1.36.4  </span></span>
<span><span class="co">## [10] IRanges_2.36.0        S4Vectors_0.40.2      BiocGenerics_0.48.1  </span></span>
<span><span class="co">## [13] knitr_1.44           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] DBI_1.1.3                               </span></span>
<span><span class="co">##   [2] bitops_1.0-7                            </span></span>
<span><span class="co">##   [3] biomaRt_2.56.1                          </span></span>
<span><span class="co">##   [4] rlang_1.1.2                             </span></span>
<span><span class="co">##   [5] magrittr_2.0.3                          </span></span>
<span><span class="co">##   [6] clue_0.3-65                             </span></span>
<span><span class="co">##   [7] compiler_4.3.1                          </span></span>
<span><span class="co">##   [8] RSQLite_2.3.1                           </span></span>
<span><span class="co">##   [9] GenomicFeatures_1.52.2                  </span></span>
<span><span class="co">##  [10] png_0.1-8                               </span></span>
<span><span class="co">##  [11] systemfonts_1.0.5                       </span></span>
<span><span class="co">##  [12] vctrs_0.6.4                             </span></span>
<span><span class="co">##  [13] stringr_1.5.0                           </span></span>
<span><span class="co">##  [14] pkgconfig_2.0.3                         </span></span>
<span><span class="co">##  [15] shape_1.4.6                             </span></span>
<span><span class="co">##  [16] crayon_1.5.2                            </span></span>
<span><span class="co">##  [17] fastmap_1.1.1                           </span></span>
<span><span class="co">##  [18] magick_2.8.0                            </span></span>
<span><span class="co">##  [19] ellipsis_0.3.2                          </span></span>
<span><span class="co">##  [20] dbplyr_2.3.4                            </span></span>
<span><span class="co">##  [21] XVector_0.40.0                          </span></span>
<span><span class="co">##  [22] utf8_1.2.3                              </span></span>
<span><span class="co">##  [23] promises_1.2.1                          </span></span>
<span><span class="co">##  [24] Rsamtools_2.16.0                        </span></span>
<span><span class="co">##  [25] rmarkdown_2.25                          </span></span>
<span><span class="co">##  [26] ragg_1.2.6                              </span></span>
<span><span class="co">##  [27] purrr_1.0.2                             </span></span>
<span><span class="co">##  [28] bit_4.0.5                               </span></span>
<span><span class="co">##  [29] xfun_0.40                               </span></span>
<span><span class="co">##  [30] zlibbioc_1.46.0                         </span></span>
<span><span class="co">##  [31] cachem_1.0.8                            </span></span>
<span><span class="co">##  [32] jsonlite_1.8.8                          </span></span>
<span><span class="co">##  [33] progress_1.2.2                          </span></span>
<span><span class="co">##  [34] blob_1.2.4                              </span></span>
<span><span class="co">##  [35] later_1.3.2                             </span></span>
<span><span class="co">##  [36] DelayedArray_0.26.7                     </span></span>
<span><span class="co">##  [37] BiocParallel_1.34.2                     </span></span>
<span><span class="co">##  [38] cluster_2.1.4                           </span></span>
<span><span class="co">##  [39] parallel_4.3.1                          </span></span>
<span><span class="co">##  [40] prettyunits_1.2.0                       </span></span>
<span><span class="co">##  [41] R6_2.5.1                                </span></span>
<span><span class="co">##  [42] bslib_0.6.1                             </span></span>
<span><span class="co">##  [43] stringi_1.7.12                          </span></span>
<span><span class="co">##  [44] RColorBrewer_1.1-3                      </span></span>
<span><span class="co">##  [45] rtracklayer_1.60.1                      </span></span>
<span><span class="co">##  [46] jquerylib_0.1.4                         </span></span>
<span><span class="co">##  [47] iterators_1.0.14                        </span></span>
<span><span class="co">##  [48] Rcpp_1.0.11                             </span></span>
<span><span class="co">##  [49] SummarizedExperiment_1.30.2             </span></span>
<span><span class="co">##  [50] httpuv_1.6.13                           </span></span>
<span><span class="co">##  [51] Matrix_1.6-1.1                          </span></span>
<span><span class="co">##  [52] tidyselect_1.2.0                        </span></span>
<span><span class="co">##  [53] abind_1.4-5                             </span></span>
<span><span class="co">##  [54] yaml_2.3.7                              </span></span>
<span><span class="co">##  [55] doParallel_1.0.17                       </span></span>
<span><span class="co">##  [56] codetools_0.2-19                        </span></span>
<span><span class="co">##  [57] curl_5.1.0                              </span></span>
<span><span class="co">##  [58] lattice_0.21-9                          </span></span>
<span><span class="co">##  [59] tibble_3.2.1                            </span></span>
<span><span class="co">##  [60] shiny_1.8.0                             </span></span>
<span><span class="co">##  [61] KEGGREST_1.40.1                         </span></span>
<span><span class="co">##  [62] evaluate_0.22                           </span></span>
<span><span class="co">##  [63] desc_1.4.2                              </span></span>
<span><span class="co">##  [64] BiocFileCache_2.8.0                     </span></span>
<span><span class="co">##  [65] xml2_1.3.6                              </span></span>
<span><span class="co">##  [66] circlize_0.4.15                         </span></span>
<span><span class="co">##  [67] Biostrings_2.68.1                       </span></span>
<span><span class="co">##  [68] pillar_1.9.0                            </span></span>
<span><span class="co">##  [69] filelock_1.0.2                          </span></span>
<span><span class="co">##  [70] MatrixGenerics_1.12.3                   </span></span>
<span><span class="co">##  [71] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2 </span></span>
<span><span class="co">##  [72] DT_0.30                                 </span></span>
<span><span class="co">##  [73] foreach_1.5.2                           </span></span>
<span><span class="co">##  [74] generics_0.1.3                          </span></span>
<span><span class="co">##  [75] rprojroot_2.0.3                         </span></span>
<span><span class="co">##  [76] RCurl_1.98-1.12                         </span></span>
<span><span class="co">##  [77] hms_1.1.3                               </span></span>
<span><span class="co">##  [78] xtable_1.8-4                            </span></span>
<span><span class="co">##  [79] glue_1.6.2                              </span></span>
<span><span class="co">##  [80] tools_4.3.1                             </span></span>
<span><span class="co">##  [81] BiocIO_1.10.0                           </span></span>
<span><span class="co">##  [82] TxDb.Hsapiens.UCSC.hg38.knownGene_3.17.0</span></span>
<span><span class="co">##  [83] GenomicAlignments_1.36.0                </span></span>
<span><span class="co">##  [84] fs_1.6.3                                </span></span>
<span><span class="co">##  [85] XML_3.99-0.14                           </span></span>
<span><span class="co">##  [86] Cairo_1.6-2                             </span></span>
<span><span class="co">##  [87] colorspace_2.1-0                        </span></span>
<span><span class="co">##  [88] GenomeInfoDbData_1.2.10                 </span></span>
<span><span class="co">##  [89] restfulr_0.0.15                         </span></span>
<span><span class="co">##  [90] cli_3.6.2                               </span></span>
<span><span class="co">##  [91] rappdirs_0.3.3                          </span></span>
<span><span class="co">##  [92] textshaping_0.3.7                       </span></span>
<span><span class="co">##  [93] fansi_1.0.5                             </span></span>
<span><span class="co">##  [94] S4Arrays_1.0.6                          </span></span>
<span><span class="co">##  [95] dplyr_1.1.3                             </span></span>
<span><span class="co">##  [96] sass_0.4.8                              </span></span>
<span><span class="co">##  [97] digest_0.6.33                           </span></span>
<span><span class="co">##  [98] rjson_0.2.21                            </span></span>
<span><span class="co">##  [99] htmlwidgets_1.6.2                       </span></span>
<span><span class="co">## [100] memoise_2.0.1                           </span></span>
<span><span class="co">## [101] htmltools_0.5.7                         </span></span>
<span><span class="co">## [102] pkgdown_2.0.7                           </span></span>
<span><span class="co">## [103] lifecycle_1.0.4                         </span></span>
<span><span class="co">## [104] httr_1.4.7                              </span></span>
<span><span class="co">## [105] mime_0.12                               </span></span>
<span><span class="co">## [106] GlobalOptions_0.1.2                     </span></span>
<span><span class="co">## [107] GO.db_3.17.0                            </span></span>
<span><span class="co">## [108] bit64_4.0.5</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  <style>nav[data-toggle='toc'] .nav .nav {display: block;}</style>
</body>
</html>
