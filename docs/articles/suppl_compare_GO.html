<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suppl 2. Compare GO annotations from online and local GREAT • rGREAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Suppl 2. Compare GO annotations from online and local GREAT">
<meta property="og:description" content="rGREAT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rGREAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Online GREAT</li>
    <li>
      <a href="../articles/online-GREAT.html">Analyze with online GREAT</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Local GREAT</li>
    <li>
      <a href="../articles/local-GREAT.html">Analyze with local GREAT</a>
    </li>
    <li>
      <a href="../articles/other-geneset-databases.html">Work with other geneset databases</a>
    </li>
    <li>
      <a href="../articles/other-organisms.html">Work with other organisms</a>
    </li>
    <li>
      <a href="../articles/group_associations.html">Get gene-region associations for a group of GO terms</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Supplementaries in the rGREAT paper</li>
    <li>
      <a href="../articles/suppl_use_background.html">Suppl 1. Use background regions</a>
    </li>
    <li>
      <a href="../articles/suppl_compare_GO.html">Suppl 2. Compare GO annotations from online and local GREAT</a>
    </li>
    <li>
      <a href="../articles/suppl_compare_online_and_local.html">Suppl 3. Compare online and local GREAT</a>
    </li>
    <li>
      <a href="../articles/suppl_compare_tss.html">Suppl 4. Compare different TSS sources</a>
    </li>
    <li>
      <a href="../articles/suppl_compare_genome_version.html">Suppl 5. Compare different genome versions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/rGREAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Suppl 2. Compare GO annotations from online and local GREAT</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 data-toc-skip class="date">2024-02-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/rGREAT/blob/HEAD/vignettes/suppl_compare_GO.Rmd" class="external-link"><code>vignettes/suppl_compare_GO.Rmd</code></a></small>
      <div class="hidden name"><code>suppl_compare_GO.Rmd</code></div>

    </div>

    
    
<p><a href="https://great-help.atlassian.net/wiki/spaces/GREAT/pages/655448/Gene+Ontology" class="external-link">According to the <strong>GREAT</strong> website</a>, the GO gene sets they use were generated between 2011 and 2012. In this document, we are going to compare the GO gene sets integrated in GREAT web service and the GO gene sets integrated in local GREAT analysis.</p>
<p><strong>GREAT</strong> does not provide files of gene sets they use, but in the result table from GREAT analysis, there is a column “Hyper_Total_Genes” which is the total number of genes in each gene set, which we can use to compare.</p>
<p>Total number of genes in gene sets is not affected by which input regions to use. Here we simply generate a random set of input regions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/rGREAT" class="external-link">rGREAT</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'S4Vectors' was built under R version 4.3.2</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="../reference/randomRegions.html">randomRegions</a></span><span class="op">(</span>genome <span class="op">=</span> <span class="st">"hg19"</span><span class="op">)</span></span></code></pre></div>
<p>We first perform the online GREAT analysis and retrieve enrichment result for the <a href="GO:BP" class="uri">GO:BP</a> ontology.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">job</span> <span class="op">=</span> <span class="fu"><a href="../reference/submitGreatJob.html">submitGreatJob</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></span>
<span><span class="va">tbl</span> <span class="op">=</span> <span class="fu"><a href="../reference/getEnrichmentTables-dispatch.html">getEnrichmentTables</a></span><span class="op">(</span><span class="va">job</span><span class="op">)</span></span>
<span><span class="va">tb1</span> <span class="op">=</span> <span class="va">tbl</span><span class="op">[[</span><span class="st">"GO Biological Process"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Next we perform local GREAT analysis. We use the same TSS definition as online GREAT, but here GO gene sets are from the <strong>GO.db</strong> package (versio 3.14).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res2</span> <span class="op">=</span> <span class="fu"><a href="../reference/great.html">great</a></span><span class="op">(</span><span class="va">gr</span>, <span class="st">"GO:BP"</span>, <span class="st">"GREAT:hg19"</span>, min_gene_set_size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">tb2</span> <span class="op">=</span> <span class="fu"><a href="../reference/getEnrichmentTable-dispatch.html">getEnrichmentTable</a></span><span class="op">(</span><span class="va">res2</span>, min_region_hits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><code>tb1</code> and <code>tb2</code> contain the full set of GO terms under test, thus, we can compare the GO terms in the two sources:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jolars/eulerr" class="external-link">eulerr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://jolars.github.io/eulerr/reference/euler.html" class="external-link">euler</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>GREAT <span class="op">=</span> <span class="va">tb1</span><span class="op">$</span><span class="va">ID</span>, <span class="st">"GO.db"</span> <span class="op">=</span> <span class="va">tb2</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span>, quantities <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="suppl_compare_GO_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
<p>So basically, the two GO sources have very high agreement, but <strong>GO.db</strong> has more additional GO terms.</p>
<p>The absolute numbers of GO terms are less important because some very general GO terms might be filtered out by one source. For the ease of comparison, we take the common GO terms in the two sources:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tb1</span><span class="op">)</span> <span class="op">=</span> <span class="va">tb1</span><span class="op">$</span><span class="va">ID</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tb2</span><span class="op">)</span> <span class="op">=</span> <span class="va">tb2</span><span class="op">$</span><span class="va">id</span></span>
<span></span>
<span><span class="va">cn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tb1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tb2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 12221</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb1</span> <span class="op">=</span> <span class="va">tb1</span><span class="op">[</span><span class="va">cn</span>, <span class="op">]</span></span>
<span><span class="va">tb2</span> <span class="op">=</span> <span class="va">tb2</span><span class="op">[</span><span class="va">cn</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tb1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    ID                                         name</span></span>
<span><span class="co">## GO:0072227 GO:0072227         metanephric macula densa development</span></span>
<span><span class="co">## GO:0072240 GO:0072240         metanephric DCT cell differentiation</span></span>
<span><span class="co">## GO:0072236 GO:0072236        metanephric loop of Henle development</span></span>
<span><span class="co">## GO:0072233 GO:0072233 metanephric thick ascending limb development</span></span>
<span><span class="co">## GO:0021793 GO:0021793         chemorepulsion of branchiomotor axon</span></span>
<span><span class="co">## GO:0072218 GO:0072218  metanephric ascending thin limb development</span></span>
<span><span class="co">##            Binom_Genome_Fraction Binom_Expected Binom_Observed_Region_Hits</span></span>
<span><span class="co">## GO:0072227          0.0004115094      0.4115094                          4</span></span>
<span><span class="co">## GO:0072240          0.0004115094      0.4115094                          4</span></span>
<span><span class="co">## GO:0072236          0.0007332667      0.7332667                          5</span></span>
<span><span class="co">## GO:0072233          0.0004364032      0.4364032                          4</span></span>
<span><span class="co">## GO:0021793          0.0005255500      0.5255500                          4</span></span>
<span><span class="co">## GO:0072218          0.0005314570      0.5314570                          4</span></span>
<span><span class="co">##            Binom_Fold_Enrichment Binom_Region_Set_Coverage Binom_Raw_PValue</span></span>
<span><span class="co">## GO:0072227              9.720313                     0.004     0.0008575702</span></span>
<span><span class="co">## GO:0072240              9.720313                     0.004     0.0008575702</span></span>
<span><span class="co">## GO:0072236              6.818802                     0.005     0.0009572741</span></span>
<span><span class="co">## GO:0072233              9.165835                     0.004     0.0010636800</span></span>
<span><span class="co">## GO:0021793              7.611074                     0.004     0.0020862570</span></span>
<span><span class="co">## GO:0072218              7.526479                     0.004     0.0021715840</span></span>
<span><span class="co">##            Binom_Adjp_BH Hyper_Total_Genes Hyper_Expected</span></span>
<span><span class="co">## GO:0072227             1                 1     0.07558359</span></span>
<span><span class="co">## GO:0072240             1                 1     0.07558359</span></span>
<span><span class="co">## GO:0072236             1                 6     0.45350150</span></span>
<span><span class="co">## GO:0072233             1                 2     0.15116720</span></span>
<span><span class="co">## GO:0021793             1                 1     0.07558359</span></span>
<span><span class="co">## GO:0072218             1                 4     0.30233440</span></span>
<span><span class="co">##            Hyper_Observed_Gene_Hits Hyper_Fold_Enrichment</span></span>
<span><span class="co">## GO:0072227                        1             13.230390</span></span>
<span><span class="co">## GO:0072240                        1             13.230390</span></span>
<span><span class="co">## GO:0072236                        2              4.410128</span></span>
<span><span class="co">## GO:0072233                        1              6.615193</span></span>
<span><span class="co">## GO:0021793                        1             13.230390</span></span>
<span><span class="co">## GO:0072218                        1              3.307596</span></span>
<span><span class="co">##            Hyper_Gene_Set_Coverage Hyper_Term_Gene_Coverage Hyper_Raw_PValue</span></span>
<span><span class="co">## GO:0072227            0.0007132668                1.0000000       0.07558359</span></span>
<span><span class="co">## GO:0072240            0.0007132668                1.0000000       0.07558359</span></span>
<span><span class="co">## GO:0072236            0.0014265340                0.3333333       0.06980381</span></span>
<span><span class="co">## GO:0072233            0.0007132668                0.5000000       0.14545810</span></span>
<span><span class="co">## GO:0021793            0.0007132668                1.0000000       0.07558359</span></span>
<span><span class="co">## GO:0072218            0.0007132668                0.2500000       0.26977100</span></span>
<span><span class="co">##            Hyper_Adjp_BH</span></span>
<span><span class="co">## GO:0072227             1</span></span>
<span><span class="co">## GO:0072240             1</span></span>
<span><span class="co">## GO:0072236             1</span></span>
<span><span class="co">## GO:0072233             1</span></span>
<span><span class="co">## GO:0021793             1</span></span>
<span><span class="co">## GO:0072218             1</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tb2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    id                                  description</span></span>
<span><span class="co">## GO:0072227 GO:0072227         metanephric macula densa development</span></span>
<span><span class="co">## GO:0072240 GO:0072240         metanephric DCT cell differentiation</span></span>
<span><span class="co">## GO:0072236 GO:0072236        metanephric loop of Henle development</span></span>
<span><span class="co">## GO:0072233 GO:0072233 metanephric thick ascending limb development</span></span>
<span><span class="co">## GO:0021793 GO:0021793         chemorepulsion of branchiomotor axon</span></span>
<span><span class="co">## GO:0072218 GO:0072218  metanephric ascending thin limb development</span></span>
<span><span class="co">##            genome_fraction observed_region_hits fold_enrichment      p_value</span></span>
<span><span class="co">## GO:0072227    0.0004132595                    4       10.532260 0.0006376033</span></span>
<span><span class="co">## GO:0072240    0.0006330327                    4        6.875723 0.0029966060</span></span>
<span><span class="co">## GO:0072236    0.0007636721                    5        7.124388 0.0007882910</span></span>
<span><span class="co">## GO:0072233    0.0004381542                    4        9.933847 0.0007913279</span></span>
<span><span class="co">## GO:0021793    0.0005259029                    4        8.276352 0.0015416652</span></span>
<span><span class="co">## GO:0072218    0.0005332099                    4        8.162933 0.0016206009</span></span>
<span><span class="co">##            p_adjust mean_tss_dist observed_gene_hits gene_set_size</span></span>
<span><span class="co">## GO:0072227        1        447070                  1             1</span></span>
<span><span class="co">## GO:0072240        1        447070                  1             3</span></span>
<span><span class="co">## GO:0072236        1        379879                  2             6</span></span>
<span><span class="co">## GO:0072233        1        447070                  1             2</span></span>
<span><span class="co">## GO:0021793        1        270810                  1             1</span></span>
<span><span class="co">## GO:0072218        1        447070                  1             4</span></span>
<span><span class="co">##            fold_enrichment_hyper p_value_hyper p_adjust_hyper</span></span>
<span><span class="co">## GO:0072227             13.088109    0.07640523      0.9224111</span></span>
<span><span class="co">## GO:0072240              4.362703    0.21215916      1.0000000</span></span>
<span><span class="co">## GO:0072236              4.362703    0.07116884      0.9224111</span></span>
<span><span class="co">## GO:0072233              6.544054    0.14697657      1.0000000</span></span>
<span><span class="co">## GO:0021793             13.088109    0.07640523      0.9224111</span></span>
<span><span class="co">## GO:0072218              3.272027    0.27236420      1.0000000</span></span></code></pre>
<p>The column <code>"Hyper_Total_Genes"</code> in <code>tb1</code> and the column <code>"gene_set_size"</code> in <code>tb2</code> all correspond to the numbers of genes in GO gene sets. We can directly compare the two columns of values.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb1</span><span class="op">$</span><span class="va">Hyper_Total_Genes</span>, <span class="va">tb2</span><span class="op">$</span><span class="va">gene_set_size</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"online-GREAT"</span>, ylab <span class="op">=</span> <span class="st">"GO.db"</span>, main <span class="op">=</span> <span class="st">"Gene set sizes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="suppl_compare_GO_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
<p>In general, the two vectors agrees very linearly.</p>
<p>Next we add a third source of GO gene sets, which is from MSigDB. Similarly, we perform local GREAT analysis and extract the enrichment table.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res3</span> <span class="op">=</span> <span class="fu"><a href="../reference/great.html">great</a></span><span class="op">(</span><span class="va">gr</span>, <span class="st">"msigdb:C5:GO:BP"</span>, <span class="st">"GREAT:hg19"</span>, min_gene_set_size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">tb3</span> <span class="op">=</span> <span class="fu"><a href="../reference/getEnrichmentTable-dispatch.html">getEnrichmentTable</a></span><span class="op">(</span><span class="va">res3</span>, min_region_hits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tb3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                                                   id</span></span>
<span><span class="co">## 1 GOBP_POSTTRANSLATIONAL_PROTEIN_TARGETING_TO_MEMBRANE_TRANSLOCATION</span></span>
<span><span class="co">## 2                                GOBP_AUTOPHAGOSOME_MEMBRANE_DOCKING</span></span>
<span><span class="co">## 3                                  GOBP_PHOSPHAGEN_METABOLIC_PROCESS</span></span>
<span><span class="co">## 4                                           GOBP_RESPONSE_TO_HORMONE</span></span>
<span><span class="co">## 5                                  GOBP_NEUTRAL_AMINO_ACID_TRANSPORT</span></span>
<span><span class="co">## 6                   GOBP_REGULATION_OF_INTEGRIN_BIOSYNTHETIC_PROCESS</span></span>
<span><span class="co">##   genome_fraction observed_region_hits fold_enrichment      p_value p_adjust</span></span>
<span><span class="co">## 1    0.0004667755                    4        9.324733 0.0009984093        1</span></span>
<span><span class="co">## 2    0.0005148619                    4        8.453835 0.0014275266        1</span></span>
<span><span class="co">## 3    0.0002526865                    3       12.918848 0.0017505115        1</span></span>
<span><span class="co">## 4    0.0861529829                  105        1.326183 0.0020804131        1</span></span>
<span><span class="co">## 5    0.0036536619                   10        2.978216 0.0024273296        1</span></span>
<span><span class="co">## 6    0.0014497056                    6        4.503560 0.0024910577        1</span></span>
<span><span class="co">##   mean_tss_dist observed_gene_hits gene_set_size fold_enrichment_hyper</span></span>
<span><span class="co">## 1         72410                  3             7              5.609190</span></span>
<span><span class="co">## 2        135819                  4             7              7.478919</span></span>
<span><span class="co">## 3        111759                  3             5              7.852865</span></span>
<span><span class="co">## 4        237855                100           825              1.586437</span></span>
<span><span class="co">## 5        123721                 10            50              2.617622</span></span>
<span><span class="co">## 6        399102                  4             5             10.470487</span></span>
<span><span class="co">##   p_value_hyper p_adjust_hyper</span></span>
<span><span class="co">## 1  1.232847e-02     0.45830777</span></span>
<span><span class="co">## 2  9.842601e-04     0.14779341</span></span>
<span><span class="co">## 3  3.957859e-03     0.29339550</span></span>
<span><span class="co">## 4  2.403872e-06     0.01492386</span></span>
<span><span class="co">## 5  4.022365e-03     0.29339550</span></span>
<span><span class="co">## 6  1.593749e-04     0.06217527</span></span></code></pre>
<p>In MSigDB, the IDs of GO gene sets are GO term names, thus we need to convert them to GO IDs:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GO.db</span><span class="op">)</span></span>
<span><span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">GOTERM</span><span class="op">)</span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">lt</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/GOTerms-class.html" class="external-link">Term</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="va">map</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">lt</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/Ontology.html" class="external-link">Ontology</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BP"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="va">map</span><span class="op">)</span></span>
<span><span class="va">map2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span>, names <span class="op">=</span> <span class="va">map</span><span class="op">)</span></span>
<span><span class="va">new_rn</span> <span class="op">=</span> <span class="va">map2</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"^GOBP_"</span>, <span class="st">""</span>, <span class="va">tb3</span><span class="op">$</span><span class="va">id</span><span class="op">)</span> <span class="op">]</span></span>
<span><span class="va">l</span> <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">new_rn</span><span class="op">)</span></span>
<span><span class="va">tb3</span> <span class="op">=</span> <span class="va">tb3</span><span class="op">[</span><span class="va">l</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tb3</span><span class="op">)</span> <span class="op">=</span> <span class="va">new_rn</span><span class="op">[</span><span class="va">l</span><span class="op">]</span></span></code></pre></div>
<p>Next we take the common GO terms in the three sources:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">cn</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tb3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5510</span></span></code></pre>
<p>You may find the number of common GO terms becomes much smaller. It is because MSigDB does not contain the full set of GO terms. Some terms that are not informative are removed there.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb1</span> <span class="op">=</span> <span class="va">tb1</span><span class="op">[</span><span class="va">cn</span>, <span class="op">]</span></span>
<span><span class="va">tb2</span> <span class="op">=</span> <span class="va">tb2</span><span class="op">[</span><span class="va">cn</span>, <span class="op">]</span></span>
<span><span class="va">tb3</span> <span class="op">=</span> <span class="va">tb3</span><span class="op">[</span><span class="va">cn</span>, <span class="op">]</span></span></code></pre></div>
<p>And we compare the gene set sizes in the three sources:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">max</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">tb1</span><span class="op">$</span><span class="va">Hyper_Total_Genes</span>, <span class="va">tb2</span><span class="op">$</span><span class="va">gene_set_size</span>, <span class="va">tb3</span><span class="op">$</span><span class="va">gene_set_size</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb1</span><span class="op">$</span><span class="va">Hyper_Total_Genes</span>, <span class="va">tb2</span><span class="op">$</span><span class="va">gene_set_size</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"online-GREAT"</span>, ylab <span class="op">=</span> <span class="st">"GO.db"</span>, main <span class="op">=</span> <span class="st">"Gene set sizes"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb1</span><span class="op">$</span><span class="va">Hyper_Total_Genes</span>, <span class="va">tb3</span><span class="op">$</span><span class="va">gene_set_size</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"online-GREAT"</span>, ylab <span class="op">=</span> <span class="st">"MSigDB"</span>, main <span class="op">=</span> <span class="st">"Gene set sizes"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb2</span><span class="op">$</span><span class="va">gene_set_size</span>, <span class="va">tb3</span><span class="op">$</span><span class="va">gene_set_size</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"GO.db"</span>, ylab <span class="op">=</span> <span class="st">"MSigDB"</span>, main <span class="op">=</span> <span class="st">"Gene set sizes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="suppl_compare_GO_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
<p>So here we see GO gene sets from <strong>GO.db</strong> and MSigDb are almost identical (the third plot), while there are certain degrees of inconsistency between online GREAT and the other two (the first two plots).</p>
<p>Now we can make the conclusion that the GO gene sets in online GREAT are outdated and are not very consistent to the most up-to-date ones.</p>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Ventura 13.2.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Berlin</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] GO.db_3.17.0         AnnotationDbi_1.62.2 Biobase_2.60.0      </span></span>
<span><span class="co">##  [4] eulerr_7.0.0         rGREAT_2.5.4         GenomicRanges_1.52.1</span></span>
<span><span class="co">##  [7] GenomeInfoDb_1.36.4  IRanges_2.36.0       S4Vectors_0.40.2    </span></span>
<span><span class="co">## [10] BiocGenerics_0.48.1  knitr_1.44          </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] DBI_1.1.3                               </span></span>
<span><span class="co">##   [2] bitops_1.0-7                            </span></span>
<span><span class="co">##   [3] biomaRt_2.56.1                          </span></span>
<span><span class="co">##   [4] rlang_1.1.2                             </span></span>
<span><span class="co">##   [5] magrittr_2.0.3                          </span></span>
<span><span class="co">##   [6] GetoptLong_1.0.5                        </span></span>
<span><span class="co">##   [7] matrixStats_1.2.0                       </span></span>
<span><span class="co">##   [8] compiler_4.3.1                          </span></span>
<span><span class="co">##   [9] RSQLite_2.3.1                           </span></span>
<span><span class="co">##  [10] GenomicFeatures_1.52.2                  </span></span>
<span><span class="co">##  [11] polylabelr_0.2.0                        </span></span>
<span><span class="co">##  [12] png_0.1-8                               </span></span>
<span><span class="co">##  [13] systemfonts_1.0.5                       </span></span>
<span><span class="co">##  [14] vctrs_0.6.4                             </span></span>
<span><span class="co">##  [15] stringr_1.5.0                           </span></span>
<span><span class="co">##  [16] pkgconfig_2.0.3                         </span></span>
<span><span class="co">##  [17] shape_1.4.6                             </span></span>
<span><span class="co">##  [18] crayon_1.5.2                            </span></span>
<span><span class="co">##  [19] fastmap_1.1.1                           </span></span>
<span><span class="co">##  [20] ellipsis_0.3.2                          </span></span>
<span><span class="co">##  [21] dbplyr_2.3.4                            </span></span>
<span><span class="co">##  [22] XVector_0.40.0                          </span></span>
<span><span class="co">##  [23] utf8_1.2.3                              </span></span>
<span><span class="co">##  [24] promises_1.2.1                          </span></span>
<span><span class="co">##  [25] Rsamtools_2.16.0                        </span></span>
<span><span class="co">##  [26] rmarkdown_2.25                          </span></span>
<span><span class="co">##  [27] ragg_1.2.6                              </span></span>
<span><span class="co">##  [28] purrr_1.0.2                             </span></span>
<span><span class="co">##  [29] bit_4.0.5                               </span></span>
<span><span class="co">##  [30] xfun_0.40                               </span></span>
<span><span class="co">##  [31] zlibbioc_1.46.0                         </span></span>
<span><span class="co">##  [32] cachem_1.0.8                            </span></span>
<span><span class="co">##  [33] jsonlite_1.8.8                          </span></span>
<span><span class="co">##  [34] progress_1.2.2                          </span></span>
<span><span class="co">##  [35] blob_1.2.4                              </span></span>
<span><span class="co">##  [36] later_1.3.2                             </span></span>
<span><span class="co">##  [37] DelayedArray_0.26.7                     </span></span>
<span><span class="co">##  [38] BiocParallel_1.34.2                     </span></span>
<span><span class="co">##  [39] parallel_4.3.1                          </span></span>
<span><span class="co">##  [40] prettyunits_1.2.0                       </span></span>
<span><span class="co">##  [41] R6_2.5.1                                </span></span>
<span><span class="co">##  [42] bslib_0.6.1                             </span></span>
<span><span class="co">##  [43] stringi_1.7.12                          </span></span>
<span><span class="co">##  [44] RColorBrewer_1.1-3                      </span></span>
<span><span class="co">##  [45] rtracklayer_1.60.1                      </span></span>
<span><span class="co">##  [46] jquerylib_0.1.4                         </span></span>
<span><span class="co">##  [47] iterators_1.0.14                        </span></span>
<span><span class="co">##  [48] Rcpp_1.0.11                             </span></span>
<span><span class="co">##  [49] SummarizedExperiment_1.30.2             </span></span>
<span><span class="co">##  [50] httpuv_1.6.13                           </span></span>
<span><span class="co">##  [51] Matrix_1.6-1.1                          </span></span>
<span><span class="co">##  [52] tidyselect_1.2.0                        </span></span>
<span><span class="co">##  [53] abind_1.4-5                             </span></span>
<span><span class="co">##  [54] yaml_2.3.7                              </span></span>
<span><span class="co">##  [55] doParallel_1.0.17                       </span></span>
<span><span class="co">##  [56] codetools_0.2-19                        </span></span>
<span><span class="co">##  [57] curl_5.1.0                              </span></span>
<span><span class="co">##  [58] lattice_0.21-9                          </span></span>
<span><span class="co">##  [59] tibble_3.2.1                            </span></span>
<span><span class="co">##  [60] shiny_1.8.0                             </span></span>
<span><span class="co">##  [61] KEGGREST_1.40.1                         </span></span>
<span><span class="co">##  [62] evaluate_0.22                           </span></span>
<span><span class="co">##  [63] desc_1.4.2                              </span></span>
<span><span class="co">##  [64] polyclip_1.10-6                         </span></span>
<span><span class="co">##  [65] BiocFileCache_2.8.0                     </span></span>
<span><span class="co">##  [66] xml2_1.3.6                              </span></span>
<span><span class="co">##  [67] circlize_0.4.15                         </span></span>
<span><span class="co">##  [68] Biostrings_2.68.1                       </span></span>
<span><span class="co">##  [69] pillar_1.9.0                            </span></span>
<span><span class="co">##  [70] filelock_1.0.2                          </span></span>
<span><span class="co">##  [71] MatrixGenerics_1.12.3                   </span></span>
<span><span class="co">##  [72] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2 </span></span>
<span><span class="co">##  [73] DT_0.30                                 </span></span>
<span><span class="co">##  [74] foreach_1.5.2                           </span></span>
<span><span class="co">##  [75] generics_0.1.3                          </span></span>
<span><span class="co">##  [76] rprojroot_2.0.3                         </span></span>
<span><span class="co">##  [77] RCurl_1.98-1.12                         </span></span>
<span><span class="co">##  [78] hms_1.1.3                               </span></span>
<span><span class="co">##  [79] xtable_1.8-4                            </span></span>
<span><span class="co">##  [80] glue_1.6.2                              </span></span>
<span><span class="co">##  [81] tools_4.3.1                             </span></span>
<span><span class="co">##  [82] BiocIO_1.10.0                           </span></span>
<span><span class="co">##  [83] TxDb.Hsapiens.UCSC.hg38.knownGene_3.17.0</span></span>
<span><span class="co">##  [84] GenomicAlignments_1.36.0                </span></span>
<span><span class="co">##  [85] fs_1.6.3                                </span></span>
<span><span class="co">##  [86] XML_3.99-0.14                           </span></span>
<span><span class="co">##  [87] grid_4.3.1                              </span></span>
<span><span class="co">##  [88] colorspace_2.1-0                        </span></span>
<span><span class="co">##  [89] GenomeInfoDbData_1.2.10                 </span></span>
<span><span class="co">##  [90] restfulr_0.0.15                         </span></span>
<span><span class="co">##  [91] cli_3.6.2                               </span></span>
<span><span class="co">##  [92] rappdirs_0.3.3                          </span></span>
<span><span class="co">##  [93] textshaping_0.3.7                       </span></span>
<span><span class="co">##  [94] fansi_1.0.5                             </span></span>
<span><span class="co">##  [95] S4Arrays_1.0.6                          </span></span>
<span><span class="co">##  [96] dplyr_1.1.3                             </span></span>
<span><span class="co">##  [97] sass_0.4.8                              </span></span>
<span><span class="co">##  [98] digest_0.6.33                           </span></span>
<span><span class="co">##  [99] org.Hs.eg.db_3.17.0                     </span></span>
<span><span class="co">## [100] rjson_0.2.21                            </span></span>
<span><span class="co">## [101] htmlwidgets_1.6.2                       </span></span>
<span><span class="co">## [102] memoise_2.0.1                           </span></span>
<span><span class="co">## [103] htmltools_0.5.7                         </span></span>
<span><span class="co">## [104] pkgdown_2.0.7                           </span></span>
<span><span class="co">## [105] lifecycle_1.0.4                         </span></span>
<span><span class="co">## [106] httr_1.4.7                              </span></span>
<span><span class="co">## [107] mime_0.12                               </span></span>
<span><span class="co">## [108] GlobalOptions_0.1.2                     </span></span>
<span><span class="co">## [109] bit64_4.0.5</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  <style>nav[data-toggle='toc'] .nav .nav {display: block;}</style>
</body>
</html>
