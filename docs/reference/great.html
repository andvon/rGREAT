<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform GREAT analysis — great • rGREAT</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform GREAT analysis — great"><meta property="og:description" content="Perform GREAT analysis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rGREAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/local-GREAT.html">Analyze with local GREAT</a>
    </li>
    <li>
      <a href="../articles/online-GREAT.html">Analyze with online GREAT</a>
    </li>
    <li>
      <a href="../articles/other-docs.html">Other documents</a>
    </li>
    <li>
      <a href="../articles/other-geneset-databases.html">Work with other geneset databases</a>
    </li>
    <li>
      <a href="../articles/other-organisms.html">Work with other organisms</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jokergoo/rGREAT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform GREAT analysis</h1>
    
    <div class="hidden name"><code>great.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform GREAT analysis</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">great</span><span class="op">(</span><span class="va">gr</span>, <span class="va">gene_sets</span>, <span class="va">tss_source</span>, biomart_dataset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    min_gene_set_size <span class="op">=</span> <span class="fl">5</span>, mode <span class="op">=</span> <span class="st">"basalPlusExt"</span>, basal_upstream <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>    basal_downstream <span class="op">=</span> <span class="fl">1000</span>, extension <span class="op">=</span> <span class="fl">1000000</span>,</span>
<span>    extended_tss <span class="op">=</span> <span class="cn">NULL</span>, background <span class="op">=</span> <span class="cn">NULL</span>, exclude <span class="op">=</span> <span class="st">"gap"</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span>, verbose <span class="op">=</span> <span class="va">great_opt</span><span class="op">$</span><span class="va">verbose</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>gr</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></code> object. This is the input regions. It is important to keep consistent for the chromosome names of the input regions and the internal TSS regions. Use <code><a href="getTSS.html">getTSS</a></code> to see the format of internal TSS regions.</p></dd>

  <dt>gene_sets</dt>
<dd><p>A single string of defautly supported gene sets collections (see the full list in "Genesets" section), or a named list of vectors where each vector correspond to a gene set.</p></dd>

  <dt>tss_source</dt>
<dd><p>Source of TSS. See "TSS" section.</p></dd>

  <dt>biomart_dataset</dt>
<dd><p>The value should be in <code><a href="https://rdrr.io/pkg/BioMartGOGeneSets/man/supportedOrganisms.html" class="external-link">BioMartGOGeneSets::supportedOrganisms</a></code>.</p></dd>

  <dt>min_gene_set_size</dt>
<dd><p>Minimal size of gene sets.</p></dd>

  <dt>mode</dt>
<dd><p>The mode to extend genes. Value should be one of 'basalPlusExt', 'twoClosest' and 'oneClosest'. See <code><a href="extendTSS.html">extendTSS</a></code> for details.</p></dd>

  <dt>basal_upstream</dt>
<dd><p>In 'basalPlusExt' mode, number of base pairs extending to the upstream of TSS to form the basal domains.</p></dd>

  <dt>basal_downstream</dt>
<dd><p>In 'basalPlusExt' mode, number of base pairs extending to the downstream of TSS to form the basal domains.</p></dd>

  <dt>extension</dt>
<dd><p>Extensions from the basal domains.</p></dd>

  <dt>extended_tss</dt>
<dd><p>If your organism is not defaultly supported, you can first prepare one by <code><a href="extendTSSFromDataFrame.html">extendTSSFromDataFrame</a></code> or <code><a href="extendTSS.html">extendTSS</a></code>, and set the object to this argument. Please see more examples in the vignette.</p></dd>

  <dt>background</dt>
<dd><p>Background regions. The value can also be a vector of chromosome names.</p></dd>

  <dt>exclude</dt>
<dd><p>Regions that are excluded from analysis such as gap regions (which can be get by <code><a href="getGapFromUCSC.html">getGapFromUCSC</a></code>). The value can also be a vector of chromosome names. It also allows a special character value <code>"gap"</code> so that gap regions for corresponding organism will be removed from the analysis.</p></dd>

  <dt>cores</dt>
<dd><p>Number of cores to use.</p></dd>

  <dt>verbose</dt>
<dd><p>Whether to print messages.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>When <code>background</code> or <code>exclude</code> is set, the analysis is restricted in the background regions, still by using Binomial method. Note
this is different from the original GREAT method which uses Fisher's exact test if background regions is set. See <code><a href="submitGreatJob.html">submitGreatJob</a></code> for explanations.</p>
<p>By default, gap regions are excluded from the analysis.</p>
    </div>
    <div id="tss">
    <h2>Tss</h2>
    <p>rGREAT supports TSS from many organisms. The value of <code>tss_source</code> should be encoded in a special format:</p>
<ul><li><p>Name of <code>TxDb.*</code> packages. Supported packages are in <code>rGREAT:::BIOC_ANNO_PKGS$txdb</code>.</p></li>
<li><p>Genome version of the organism, e.g. "hg19". Then the corresponding TxDb will be used.</p></li>
<li><p>In a format of <code>RefSeqCurated:$genome</code> where <code>$genome</code> is the genome version of an organism, such as hg19. RefSeqCurated subset will be used.</p></li>
<li><p>In a format of <code>RefSeqSelect:$genome</code> where <code>$genome</code> is the genome version of an organism, such as hg19. RefSeqSelect subset will be used.</p></li>
<li><p>In a format of <code>Gencode_v$version</code> where <code>$version</code> is gencode version, such as 19 (for human) or M21 for mouse. Gencode protein coding genes will be used.</p></li>
<li><p>In a format of <code>GREAT:$genome</code>, where <code>$genome</code> can only be mm9, mm10, hg19, hg38. The TSS from GREAT will be used.</p></li>
</ul></div>
    <div id="genesets">
    <h2>Genesets</h2>
    <p>rGREAT supports the following built-in GO gene sets for all organisms (note "GO:" can be omitted):</p>
<dl><dt>"GO:BP":</dt>
<dd><p>Biological Process, from GO.db package.</p></dd>

  <dt>"GO:CC":</dt>
<dd><p>Cellular Component, from GO.db package.</p></dd>

  <dt>"GO:MP":</dt>
<dd><p>Molecular Function, from GO.db pacakge.</p></dd>


</dl><p>rGREAT also supports built-in gene sets collections from MSigDB (note this is only for human, "msigdb:" can be omitted):</p>
<dl><dt>"msigdb:H"</dt>
<dd><p>Hallmark gene sets.</p></dd>

  <dt>"msigdb:C1"</dt>
<dd><p>Positional gene sets.</p></dd>

  <dt>"msigdb:C2"</dt>
<dd><p>Curated gene sets.</p></dd>

  <dt>"msigdb:C2:CGP"</dt>
<dd><p>C2 subcategory: chemical and genetic perturbations gene sets.</p></dd>

  <dt>"msigdb:C2:CP"</dt>
<dd><p>C2 subcategory: canonical pathways gene sets.</p></dd>

  <dt>"msigdb:C2:CP:BIOCARTA"</dt>
<dd><p>C2 subcategory: BioCarta subset of CP.</p></dd>

  <dt>"msigdb:C2:CP:KEGG"</dt>
<dd><p>C2 subcategory: KEGG subset of CP.</p></dd>

  <dt>"msigdb:C2:CP:PID"</dt>
<dd><p>C2 subcategory: PID subset of CP.</p></dd>

  <dt>"msigdb:C2:CP:REACTOME"</dt>
<dd><p>C2 subcategory: REACTOME subset of CP.</p></dd>

  <dt>"msigdb:C2:CP:WIKIPATHWAYS"</dt>
<dd><p>C2 subcategory: WIKIPATHWAYS subset of CP.</p></dd>

  <dt>"msigdb:C3"</dt>
<dd><p>Regulatory target gene sets.</p></dd>

  <dt>"msigdb:C3:MIR:MIRDB"</dt>
<dd><p>miRDB of microRNA targets gene sets.</p></dd>

  <dt>"msigdb:C3:MIR:MIR_LEGACY"</dt>
<dd><p>MIR_Legacy of MIRDB.</p></dd>

  <dt>"msigdb:C3:TFT:GTRD"</dt>
<dd><p>GTRD transcription factor targets gene sets.</p></dd>

  <dt>"msigdb:C3:TFT:TFT_LEGACY"</dt>
<dd><p>TFT_Legacy.</p></dd>

  <dt>"msigdb:C4"</dt>
<dd><p>Computational gene sets.</p></dd>

  <dt>"msigdb:C4:CGN"</dt>
<dd><p>C4 subcategory: cancer gene neighborhoods gene sets.</p></dd>

  <dt>"msigdb:C4:CM"</dt>
<dd><p>C4 subcategory: cancer modules gene sets.</p></dd>

  <dt>"msigdb:C5"</dt>
<dd><p>Ontology gene sets.</p></dd>

  <dt>"msigdb:C5:GO:BP"</dt>
<dd><p>C5 subcategory: BP subset.</p></dd>

  <dt>"msigdb:C5:GO:CC"</dt>
<dd><p>C5 subcategory: CC subset.</p></dd>

  <dt>"msigdb:C5:GO:MF"</dt>
<dd><p>C5 subcategory: MF subset.</p></dd>

  <dt>"msigdb:C5:HPO"</dt>
<dd><p>C5 subcategory: human phenotype ontology gene sets.</p></dd>

  <dt>"msigdb:C6"</dt>
<dd><p>Oncogenic signature gene sets.</p></dd>

  <dt>"msigdb:C7"</dt>
<dd><p>Immunologic signature gene sets.</p></dd>

  <dt>"msigdb:C7:IMMUNESIGDB"</dt>
<dd><p>ImmuneSigDB subset of C7.</p></dd>

  <dt>"msigdb:C7:VAX"</dt>
<dd><p>C7 subcategory: vaccine response gene sets.</p></dd>

  <dt>"msigdb:C8"</dt>
<dd><p>Cell type signature gene sets.</p></dd>


</dl><p>If the defaultly supported TxDb is used, Entrez gene ID is always used as the main gene ID. If you provide a self-defined
<code>gene_sets</code> or <code>extended_tss</code>, you need to make sure they two have the same gene ID types.</p>
    </div>
    <div id="biomart">
    <h2>Biomart</h2>
    <p>rGREAT supports a large number of organisms of which the information is retrieved from Ensembl BioMart. The name of a BioMart dataset
can be assigned to argument <code>biomart_dataset</code>. All supported organisms can be found with <code><a href="https://rdrr.io/pkg/BioMartGOGeneSets/man/supportedOrganisms.html" class="external-link">BioMartGOGeneSets::supportedOrganisms</a></code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code><a href="GreatObject-class.html">GreatObject-class</a></code> object. The following methods can be applied on it:</p>


<ul><li><p><code><a href="getEnrichmentTable-GreatObject-method.html">getEnrichmentTable,GreatObject-method</a></code> to retrieve the result table.</p></li>
<li><p><code><a href="getRegionGeneAssociations-GreatObject-method.html">getRegionGeneAssociations,GreatObject-method</a></code> to get the associations between input regions and genes.</p></li>
<li><p><code><a href="plotRegionGeneAssociations-GreatObject-method.html">plotRegionGeneAssociations,GreatObject-method</a></code> to plot the associations bewteen input regions and genes.</p></li>
<li><p><code><a href="shinyReport-GreatObject-method.html">shinyReport,GreatObject-method</a></code> to view the results by a shiny application.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">=</span> <span class="fu"><a href="randomRegions.html">randomRegions</a></span><span class="op">(</span>genome <span class="op">=</span> <span class="st">"hg19"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">great</span><span class="op">(</span><span class="va">gr</span>, <span class="st">"MSigDB:H"</span>, <span class="st">"txdb:hg19"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">great</span><span class="op">(</span><span class="va">gr</span>, <span class="st">"MSigDB:H"</span>, <span class="st">"TxDb.Hsapiens.UCSC.hg19.knownGene"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">great</span><span class="op">(</span><span class="va">gr</span>, <span class="st">"MSigDB:H"</span>, <span class="st">"RefSeq:hg19"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">great</span><span class="op">(</span><span class="va">gr</span>, <span class="st">"MSigDB:H"</span>, <span class="st">"GREAT:hg19"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">great</span><span class="op">(</span><span class="va">gr</span>, <span class="st">"MSigDB:H"</span>, <span class="st">"Gencode_v19"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">great</span><span class="op">(</span><span class="va">gr</span>, <span class="st">"GO:BP"</span>, <span class="st">"hsapiens_gene_ensembl"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

