<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Client for GREAT Analysis • rGREAT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Client for GREAT Analysis">
<meta property="og:description" content="This package makes GREAT (Genomic Regions Enrichment of 
    Annotations Tool) analysis automatic by constructing a HTTP POST 
    request according to user's input and automatically retrieving results 
    from GREAT web server.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">rGREAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.19.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/rGREAT.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/rGREAT/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="client-for-great-analysis" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#client-for-great-analysis" class="anchor"></a>Client for GREAT Analysis</h1></div>

<p><strong>Note: <a href="http://great.stanford.edu/help/display/GREAT/Version+History">On Aug 19 2019 GREAT released version 4</a> where it supports <code>hg38</code> genome and removes some ontologies such pathways. <code><a href="reference/submitGreatJob.html">submitGreatJob()</a></code> still takes <code>hg19</code> as default. <code>hg38</code> can be specified by the <code>species = "hg38"</code> argument. To use the older versions such as 3.0.0, specify as <code><a href="reference/submitGreatJob.html">submitGreatJob(..., version = "3.0.0")</a></code>.</strong></p>
<p>This package makes <a href="http://great.stanford.edu">GREAT</a> (Genomic Regions Enrichment of Annotations Tool) analysis automatic by constructing a HTTP POST request according to user’s input and automatically retrieving results from GREAT web server.</p>
<div id="install" class="section level2">
<h2 class="hasAnchor">
<a href="#install" class="anchor"></a>Install</h2>
<p><strong>rGREAT</strong> is available on Bioconductor (<a href="http://bioconductor.org/packages/devel/bioc/html/rGREAT.html" class="uri">http://bioconductor.org/packages/devel/bioc/html/rGREAT.html</a>)</p>
<div class="sourceCode"><pre class="r"><span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, <span class="kw">quietly</span><span class="kw">=</span><span class="fl">TRUE</span>))
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
<span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"rGREAT"</span>)</pre></div>
<p>If you want the latest version, install it directly from GitHub:</p>
<pre class="{r}"><code><a href="https://devtools.r-lib.org//reference">library(devtools)
install_github("jokergoo/rGREAT")</a></code></pre>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>The input data is a <code>GRanges</code> object or a <em>BED</em>-format data frame, no matter it is sorted or not.</p>
<div class="sourceCode"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rGREAT</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">bed</span> <span class="kw">=</span> <span class="kw pkg">circlize</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/generateRandomBed.html">generateRandomBed</a></span>(<span class="kw">nr</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">nc</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">bed</span>)</pre></div>
<pre><code>##    chr    start      end
## 1 chr1   155726  2608935
## 2 chr1  6134977 10483365
## 3 chr1 11354986 11423447
## 4 chr1 15134641 19115321
## 5 chr1 22692774 23328609
## 6 chr1 23639094 25639077</code></pre>
<p>You can get the summary of your job by calling <code>job</code> variable.</p>
<div class="sourceCode"><pre class="r"><span class="no">job</span> <span class="kw">=</span> <span class="fu"><a href="reference/submitGreatJob.html">submitGreatJob</a></span>(<span class="no">bed</span>)
<span class="no">job</span></pre></div>
<pre><code>## 
## Submit time: 2014-12-24 20:36:20 
## Species: hg19 
## Background: wholeGenome 
## Model: Basal plus extension 
##   Proximal: 5 kb upstream, 1 kb downstream,
##   plus Distal: up to 1000 kb
## Include curated regulatory domains
## 
## Ontologies enrichment that has been downloaded:
##   None</code></pre>
<p>With <code>job</code>, we can now retrieve results from GREAT. The first and the primary results are the tables which contain enrichment statistics for the analysis. By default it will retrieve results from three GO Ontologies and all pathway ontologies. All tables contains statistics for all terms no matter they are significant or not. Users can then make filtering by a self-defined cutoff.</p>
<div class="sourceCode"><pre class="r"><span class="no">tb</span> <span class="kw">=</span> <span class="fu"><a href="reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables</a></span>(<span class="no">job</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">tb</span>)</pre></div>
<pre><code>## [1] "GO_Molecular_Function" "GO_Biological_Process" "GO_Cellular_Component" "PANTHER_Pathway"      
## [5] "Pathway_Commons"       "BioCyc_Pathway"        "MSigDB_Pathway"</code></pre>
<div class="sourceCode"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb</span><span class="kw">[[</span><span class="fl">1</span>]])</pre></div>
<pre><code>##           ID                                     name Binom_Genome_Fraction Binom_Expected
## 1 GO:0016841                   ammonia-lyase activity          1.117309e-04     0.11228950
## 2 GO:0003796                        lysozyme activity          1.137105e-03     1.14279100
## 3 GO:0004731 purine-nucleoside phosphorylase activity          1.436141e-05     0.01443321
## 4 GO:0008111   alpha-methylacyl-CoA racemase activity          1.837979e-05     0.01847169
## 5 GO:0051635           bacterial cell surface binding          2.087516e-03     2.09795300
## 6 GO:0016034    maleylacetoacetate isomerase activity          2.102749e-05     0.02113263
##   Binom_Observed_Region_Hits Binom_Fold_Enrichment Binom_Region_Set_Coverage Binom_Raw_PValue
## 1                          2             17.811100              0.0019900500      0.005846831
## 2                          5              4.375254              0.0049751240      0.006317406
## 3                          1             69.284640              0.0009950249      0.014329660
## 4                          1             54.136900              0.0009950249      0.018302300
## 5                          6              2.859930              0.0059701490      0.020238010
## 6                          1             47.320190              0.0009950249      0.020911120
##   Hyper_Total_Genes Hyper_Expected Hyper_Observed_Gene_Hits Hyper_Fold_Enrichment
## 1                 5     0.44832060                        2              4.461094
## 2                12     1.07596900                        4              3.717578
## 3                 1     0.08966411                        1             11.152730
## 4                 1     0.08966411                        1             11.152730
## 5                17     1.52429000                        4              2.624173
## 6                 1     0.08966411                        1             11.152730
##   Hyper_Gene_Set_Coverage Hyper_Term_Gene_Coverage Hyper_Raw_PValue
## 1            0.0012570710                0.4000000       0.06690106
## 2            0.0025141420                0.3333333       0.01772786
## 3            0.0006285355                1.0000000       0.08966411
## 4            0.0006285355                1.0000000       0.08966411
## 5            0.0025141420                0.2352941       0.05957762
## 6            0.0006285355                1.0000000       0.08966411</code></pre>
<p>Association between genomic regions and genes can be get by <code><a href="reference/plotRegionGeneAssociationGraphs-GreatJob-method.html">plotRegionGeneAssociationGraphs()</a></code>. The function will make the three plots which are same as on GREAT website and returns a <code>GRanges</code> object which contains the associations.</p>
<div class="sourceCode"><pre class="r"><span class="no">res</span> <span class="kw">=</span> <span class="fu"><a href="reference/plotRegionGeneAssociationGraphs-GreatJob-method.html">plotRegionGeneAssociationGraphs</a></span>(<span class="no">job</span>)</pre></div>
<p><img src="https://cloud.githubusercontent.com/assets/449218/5553875/96849e3c-8c33-11e4-8424-b263ee3b6818.png" alt="1"></p>
<div class="sourceCode"><pre class="r"><span class="no">res</span></pre></div>
<pre><code>## GRanges object with 1716 ranges and 2 metadata columns:
##          seqnames               ranges strand   |        gene   distTSS
##             &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt;   | &lt;character&gt; &lt;numeric&gt;
##      [1]     chr1 [  155726,  2608935]      *   |      ATAD3C     -2738
##      [2]     chr1 [ 6134977, 10483365]      *   |      ERRFI1   -222778
##      [3]     chr1 [ 6134977, 10483365]      *   |     SLC45A1    -75219
##      [4]     chr1 [11354986, 11423447]      *   |      PTCHD2   -150078
##      [5]     chr1 [11354986, 11423447]      *   |      UBIAD1     55962
##      ...      ...                  ...    ... ...         ...       ...
##   [1712]     chrY [36594469, 36986560]      *   |        &lt;NA&gt;      &lt;NA&gt;
##   [1713]     chrY [38466369, 40094584]      *   |        &lt;NA&gt;      &lt;NA&gt;
##   [1714]     chrY [44554177, 44654068]      *   |        &lt;NA&gt;      &lt;NA&gt;
##   [1715]     chrY [46572517, 50931029]      *   |        &lt;NA&gt;      &lt;NA&gt;
##   [1716]     chrY [53045400, 56467562]      *   |        &lt;NA&gt;      &lt;NA&gt;
##   -------
##   seqinfo: 24 sequences from an unspecified genome; no seqlengths</code></pre>
<p>By specifying ontology and term ID, you can get the association in certain term. Here the term ID is from the first column of the data frame which is returned by <code><a href="reference/getEnrichmentTables-GreatJob-method.html">getEnrichmentTables()</a></code>.</p>
<div class="sourceCode"><pre class="r"><span class="no">res</span> <span class="kw">=</span> <span class="fu"><a href="reference/plotRegionGeneAssociationGraphs-GreatJob-method.html">plotRegionGeneAssociationGraphs</a></span>(<span class="no">job</span>, <span class="kw">ontology</span> <span class="kw">=</span> <span class="st">"GO_Molecular_Function"</span>,
    <span class="kw">termID</span> <span class="kw">=</span> <span class="st">"GO:0004984"</span>)</pre></div>
<p><img src="https://cloud.githubusercontent.com/assets/449218/5553879/bd7fa216-8c33-11e4-8638-ee3d8348d5c0.png" alt="2"></p>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>MIT @ Zuguang Gu</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from BIOC at <br><a href="https://www.bioconductor.org/packages/rGREAT">https://​www.bioconductor.org/​packages/​rGREAT</a>
</li>
<li>Browse source code at <br><a href="https://github.com/jokergoo/rGREAT/">https://​github.com/​jokergoo/​rGREAT/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Zuguang Gu <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/jokergoo/rGREAT"><img src="https://travis-ci.org/jokergoo/rGREAT.svg" alt="Status"></a></li>
<li><a href="https://codecov.io/github/jokergoo/rGREAT"><img src="https://img.shields.io/codecov/c/github/jokergoo/rGREAT.svg" alt="codecov"></a></li>
<li><a href="https://bioconductor.org/packages/stats/bioc/rGREAT/"><img src="https://bioconductor.org/shields/downloads/devel/rGREAT.svg" alt="bioc"></a></li>
<li><a href="http://bioconductor.org/packages/devel/bioc/html/rGREAT.html"><img src="http://www.bioconductor.org/shields/years-in-bioc/rGREAT.svg" alt="bioc"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
